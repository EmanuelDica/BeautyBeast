@page "/"
@using BeautyBeastServer.Dtos
@inject Services.PostService PostsService
@inject Services.StatusService StatusService

<MudPaper Class="pa-4">
    <MudText Typo="Typo.h5">Dashboard</MudText>
    
    @if (posts == null || statuses == null)
    {
        <MudText>Loading...</MudText>
    }
    else
    {
        @foreach (var post in posts)
        {
            <MudCard Class="ma-2">
                <MudCardContent>
                    <MudText Typo="Typo.body1">@($"[POST] {post.Description}")</MudText>
                </MudCardContent>
            </MudCard>
        }

        @foreach (var status in statuses)
        {
            <MudCard Class="ma-2">
                <MudCardContent>
                    <MudText Typo="Typo.body1">@($"[STATUS] {status.Text}")</MudText>
                </MudCardContent>
            </MudCard>
        }
    }
</MudPaper>

@code {
    private List<PostDto> posts = new();
    private List<StatusDto> statuses = new();

    protected override async Task OnInitializedAsync()
    {
        try
        {
            posts = await PostsService.GetAllPostsAsync();
            statuses = await StatusService.GetAllStatusesAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading dashboard data: {ex.Message}");
        }
    }
}